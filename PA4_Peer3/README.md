# PA4: "Matrix Multiplication"

# Project Description

Program that multiplies two matrices. Information about matrix multiplication can be found on [Wolfram Mathworld](http://mathworld.wolfram.com/MatrixMultiplication.html). The project was implemented both sequentially and with parallelization.

The results of the experiment are detailed in Report.pdf.

# Dependencies, Building, and Running

## Dependency Instructions
These projects depend on the MPI Library and SLURM Running environment preinstalled in [h1.cse.unr.edu](h1.cse.unr.edu). Connect via ssh:
```bash
ssh username@ubuntu.cse.unr.edu
ssh username@h1.cse.unr.edu
```

## Building
Building and running must be done from inside the build folder. A makefile is used for building:
```bash
cd build
make
```

## Creating Data Sets
Once the project has been built (see above), matrices can be created.
```bash
cd build
./generator
```
The program prompt the user for the value of n. Matrix A will have the dimensions n x n; matrix B will have the dimensions n x n. The resulting matrix will be n x n. The generator will create random values for matrices A and B. The minimum value is 0; the maximum is set by MAX_SIZE. The program will write to dataset.txt in the bin directory.

The sequential nonsquare program can run matrices that are not square. To generate this data:
```bash
cd build
./generator_nonsquare
```
The program prompt the user for values for n, m, and p. Matrix A will have the dimensions n x m; matrix B will have the dimensions m x p. The resulting matrix will be n x p. The generator will create random values for matrices A and B. The minimum value is 0; the maximum is set by MAX_SIZE. The program will write to dataset_nonsquare.txt in the bin directory.

## Running
After building, run the projects from the build directory. The sequential version can be run using:
```bash
./run_sequential.sh
```
To multiply nonsquare matrices (must be ran with data generated by generator_nonsquare):
```bash
./run_sequential_nonsquare.sh
```
The parallel script can run across 4, 9, 16, and 25 cores. The number of cores must be a factor of n. To run a job with a specific number of cores (replacing 4 with the desired number of cores):
```bash
sbatch parallel_4.sh
```
To run jobs but wait for each to finish before queuing the next (must run with appropriate matrix sizes):
```bash
./wait_parallel.sh
```

The program will read data for matrices A and B from datafile.txt in the bin directory. When the TRIALS flag is set to 1, the program will run NUM_TRIALS times. When TRIALS is set to 0, the program will run once. The run times will be recorded and the average will be written to a file, disregarding the minimum and maximum run times.
Each run time will be printed to the console. The average trial will be written to the associated log file in the bin directory.
For the parallelized implementation, the console output can be found in the slurm-jobnumber.out.
The resulting matrix will be written to matrix.txt in the bin directory if WRITE\_FILE is set to 1. If WRITE\_FILE is set to 0, the matrix will not be written.

## Cleaning
Cleaning must be done from inside the build directory:
```bash
cd build
make clean
```  
